namespace AdventOfCode2024.Tests;

public class Day8Tests
{
    public static TheoryData<string, int> Data => new()
    {
        { "", 0 },
        {
            """
            .aa
            """,
            1
        },
        {
            """
            .AA
            """,
            1
        },
        {
            """
            .00
            """,
            1
        },
        {
            """
            .bb
            """,
            1
        },
        {
            """
            .aa.
            """,
            2
        },
        {
            """
            ..a.a..
            """,
            2
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ..........
            .....a....
            ..........
            ..........
            ..........
            ..........
            """,
            2
        },
        {
            """
            .a.a..
            """,
            1
        },
        {
            """
            .a.a.
            """,
            0
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ........a.
            .....a....
            ..........
            ..........
            ..........
            ..........
            """,
            4
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ........a.
            ..........
            ..........
            ..........
            ..........
            ..........
            """,
            1
        },
        {
            """
            ..........
            ....a.....
            ........a.
            ..........
            ..........
            """,
            1
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ........b.
            .....a....
            ..........
            ..........
            ..........
            ..........
            """,
            2
        },
        {
            """
            .aa
            .bb
            """,
            2
        },
        {
            """
            .aa
            bb.
            """,
            2
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ........a.
            .....a....
            ..........
            ......A...
            ..........
            ..........
            """,
            4
        },
        {
            """
            ............
            ........0...
            .....0......
            .......0....
            ....0.......
            ......A.....
            ............
            ............
            ........A...
            .........A..
            ............
            ............
            """,
            14
        },
        { File.ReadAllText("Day8.txt"), 244 }
    };

    [Theory]
    [MemberData(nameof(Data))]
    public void GetAntinodeCount(string input, int expected)
    {
        int actual = Day8.GetAntinodeCount(input);

        Assert.Equal(expected, actual);
    }

    public static TheoryData<string, int> DataPart2 => new()
    {
        { "", 0 },
        { "aa", 2 },
        {
            """
            .aa
            """,
            3
        },
        {
            """
            .AA
            """,
            3
        },
        {
            """
            .00
            """,
            3
        },
        {
            """
            .bb
            """,
            3
        },
        {
            """
            .aa.
            """,
            4
        },
        {
            """
            ..a.a..
            """,
            4
        },
        {
            """
            a
            .
            a
            .
            .
            .
            .
            """,
            4
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ..........
            .....a....
            ..........
            ..........
            ..........
            ..........
            """,
            5
        },
        {
            """
            .a.a..
            """,
            3
        },
        {
            """
            .a.a.
            """,
            2
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ........a.
            .....a....
            ..........
            ..........
            ..........
            ..........
            """,
            8
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ........a.
            ..........
            ..........
            ..........
            ..........
            ..........
            """,
            3
        },
        {
            """
            ..........
            ....a.....
            ........a.
            ..........
            ..........
            """,
            3
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ........b.
            .....a....
            ..........
            ..........
            ..........
            ..........
            """,
            5
        },
        {
            """
            .aa
            .bb
            """,
            6
        },
        {
            """
            .aa
            bb.
            """,
            6
        },
        {
            """
            ..........
            ..........
            ..........
            ....a.....
            ........a.
            .....a....
            ..........
            ......A...
            ..........
            ..........
            """,
            8
        },
        {
            """
            ............
            ........0...
            .....0......
            .......0....
            ....0.......
            ......A.....
            ............
            ............
            ........A...
            .........A..
            ............
            ............
            """,
            34
        },
        { File.ReadAllText("Day8.txt"), 912 }
    };

    [Theory]
    [MemberData(nameof(DataPart2))]
    public void GetAntinodeCountPart2(string input, int expected)
    {
        int actual = Day8.GetAntinodeCount(input, part2: true);

        Assert.Equal(expected, actual);
    }
}